#include "us.h"
#include "../locale.h"

uint8_t hid_keycode_to_ascii_us[][2] = {
    {0, 0},       /* 0x00 */
    {0, 0},       /* 0x01 */
    {0, 0},       /* 0x02 */
    {0, 0},       /* 0x03 */
    {'a', 'A'},   /* 0x04 */
    {'b', 'B'},   /* 0x05 */
    {'c', 'C'},   /* 0x06 */
    {'d', 'D'},   /* 0x07 */
    {'e', 'E'},   /* 0x08 */
    {'f', 'F'},   /* 0x09 */
    {'g', 'G'},   /* 0x0a */
    {'h', 'H'},   /* 0x0b */
    {'i', 'I'},   /* 0x0c */
    {'j', 'J'},   /* 0x0d */
    {'k', 'K'},   /* 0x0e */
    {'l', 'L'},   /* 0x0f */
    {'m', 'M'},   /* 0x10 */
    {'n', 'N'},   /* 0x11 */
    {'o', 'O'},   /* 0x12 */
    {'p', 'P'},   /* 0x13 */
    {'q', 'Q'},   /* 0x14 */
    {'r', 'R'},   /* 0x15 */
    {'s', 'S'},   /* 0x16 */
    {'t', 'T'},   /* 0x17 */
    {'u', 'U'},   /* 0x18 */
    {'v', 'V'},   /* 0x19 */
    {'w', 'W'},   /* 0x1a */
    {'x', 'X'},   /* 0x1b */
    {'y', 'Y'},   /* 0x1c */
    {'z', 'Z'},   /* 0x1d */
    {'1', '!'},   /* 0x1e */
    {'2', '@'},   /* 0x1f */
    {'3', '#'},   /* 0x20 */
    {'4', '$'},   /* 0x21 */
    {'5', '%'},   /* 0x22 */
    {'6', '^'},   /* 0x23 */
    {'7', '&'},   /* 0x24 */
    {'8', '*'},   /* 0x25 */
    {'9', '('},   /* 0x26 */
    {'0', ')'},   /* 0x27 */
    {'\n', '\n'}, /* 0x28 */
    {27, 27},     /* 0x29 ESC */
    {'\b', '\b'}, /* 0x2a */
    {' ', ' '},   /* 0x2b */
    {' ', ' '},   /* 0x2c */
    {'-', '_'},   /* 0x2d */
    {'=', '+'},   /* 0x2e */
    {'[', '{'},   /* 0x2f */
    {']', '}'},   /* 0x30 */
    {' ', '|'},   /* 0x31 */
    {'\\', '|'},  /* 0x32 */
    {';', ':'},   /* 0x33 */
    {'\'', '"'},  /* 0x34 */
    {'`', '~'},   /* 0x35 */
    {',', '<'},   /* 0x36 */
    {'.', '>'},   /* 0x37 */
    {'/', '?'},   /* 0x38 */
    {0, 0},       /* 0x39 */
    {0, 0},       /* 0x3a */
    {0, 0},       /* 0x3b */
    {0, 0},       /* 0x3c */
    {0, 0},       /* 0x3d */
    {5, 5},       /* 0x3e F5 */
    {0, 0},       /* 0x3f */
    {0, 0},       /* 0x40 */
    {0, 0},       /* 0x41 */
    {0, 0},       /* 0x42 */
    {0, 0},       /* 0x43 */
    {0, 0},       /* 0x44 */
    {0, 0},       /* 0x45 */
    {0, 0},       /* 0x46 */
    {0, 0},       /* 0x47 */
    {24, 24},     /* 0x48 PAUSE */
    {0, 0},       /* 0x49 */
    {2, 0},       /* 0x4a Home */
    {22, 0},      /* 0x4b PAGE UP */
    {127, 127},   /* 0x4c */
    {3, 0},       /* 0x4d End */
    {23, 0},      /* 0x4e PAGE DOWN */
    {19, 0},      /* 0x4f Right */
    {18, 0},      /* 0x50 Left */
    {21, 0},      /* 0x51 Down */
    {20, 0},      /* 0x52 Up */
    {0, 0},       /* 0x53 */
    {'/', '/'},   /* 0x54 */
    {'*', '*'},   /* 0x55 */
    {'-', '-'},   /* 0x56 */
    {'+', '+'},   /* 0x57 */
    {'n', 'n'},   /* 0x58 */
    {'1', 0},     /* 0x59 */
    {'2', 0},     /* 0x5a */
    {'3', 0},     /* 0x5b */
    {'4', 0},     /* 0x5c */
    {'5', '5'},   /* 0x5d */
    {'6', 0},     /* 0x5e */
    {'7', 0},     /* 0x5f */
    {'8', 0},     /* 0x60 */
    {'9', 0},     /* 0x61 */
    {'0', 0},     /* 0x62 */
    {'.', 0},     /* 0x63 */
    {0, 0},       /* 0x64 */
    {0, 0},       /* 0x65 */
    {0, 0},       /* 0x66 */
    {'=', '='},   /* 0x67 */
};

// Function to get the ASCII value from HID keycode and modifier
uint8_t keyboard_keycode_ascii_us(int keycode, bool shift)
{
    if (keycode >= sizeof(hid_keycode_to_ascii_us) / sizeof(hid_keycode_to_ascii_us[0]))
    {
        return 0; // Invalid keycode
    }

    // go through capslock filter
    int ascii = hid_keycode_to_ascii_us[keycode][shift ? 1 : 0];
    ascii = keyboard_caplock_filter(ascii);

    return ascii;
}
